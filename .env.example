# =============================================================================
# Threat Hunter Pro - Environment Configuration Example
# =============================================================================
# This file contains all required and optional environment variables for
# Threat Hunter Pro. Copy this file to .env and configure with your values.
# 
# SECURITY WARNING: Never commit .env files to version control!
# =============================================================================

# =============================================================================
# CORE APPLICATION SETTINGS
# =============================================================================

# Basic Authentication (REQUIRED)
# Used for HTTP Basic authentication on all protected endpoints
BASIC_AUTH_USER=admin
BASIC_AUTH_PASS=your_secure_password_here

# =============================================================================
# AI/ML API KEYS (REQUIRED)
# =============================================================================

# Primary Gemini API Key (REQUIRED)
# Get from Google AI Studio: https://makersuite.google.com/app/apikey
GEMINI_API_KEY=your_gemini_api_key_here

# Secondary Gemini API Keys (OPTIONAL)
# Additional keys for rate limit rotation and redundancy
GEMINI_API_KEY_2=your_secondary_gemini_api_key
GEMINI_API_KEY_3=your_tertiary_gemini_api_key

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Master Encryption Key for Secrets Management
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
SECRETS_ENCRYPTION_KEY=your_base64_encoded_encryption_key_here

# JWT Secret for Token Authentication
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET=your_jwt_secret_key_here

# Password Hash Salt (OPTIONAL)
# Used for additional password security
PASSWORD_SALT=your_password_salt_here

# Session Security
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
SESSION_SECRET_KEY=your_session_secret_key_here

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Database Connection (if using external database)
DATABASE_URL=postgresql://username:password@localhost:5432/threathunter
DATABASE_PASSWORD=your_database_password_here

# Redis Configuration (if using Redis for caching/sessions)
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=your_redis_password_here

# =============================================================================
# EXTERNAL SERVICES INTEGRATION
# =============================================================================

# HashiCorp Vault Integration (OPTIONAL)
VAULT_URL=https://vault.example.com:8200
VAULT_TOKEN=your_vault_token_here
VAULT_NAMESPACE=your_vault_namespace
VAULT_MOUNT_POINT=secret

# AWS Secrets Manager Integration (OPTIONAL)
AWS_ACCESS_KEY_ID=your_aws_access_key_id
AWS_SECRET_ACCESS_KEY=your_aws_secret_access_key
AWS_REGION=us-east-1
AWS_SESSION_TOKEN=your_aws_session_token

# Azure Key Vault Integration (OPTIONAL)
AZURE_CLIENT_ID=your_azure_client_id
AZURE_CLIENT_SECRET=your_azure_client_secret
AZURE_TENANT_ID=your_azure_tenant_id
AZURE_VAULT_URL=https://your-vault.vault.azure.net/

# Google Cloud Secret Manager (OPTIONAL)
GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account-key.json
GCP_PROJECT_ID=your-gcp-project-id

# =============================================================================
# LOGGING AND MONITORING
# =============================================================================

# Log Levels (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO
SECURITY_LOG_LEVEL=WARNING

# Log File Paths
LOG_FILE=/var/log/threat_hunter/application.log
SECURITY_LOG_FILE=/var/log/threat_hunter/security.log
AUDIT_LOG_FILE=/var/log/threat_hunter/audit.log

# Syslog Configuration (OPTIONAL)
SYSLOG_HOST=localhost
SYSLOG_PORT=514
SYSLOG_FACILITY=local0

# External Monitoring (OPTIONAL)
PROMETHEUS_METRICS_PORT=9090
GRAFANA_API_KEY=your_grafana_api_key
ELASTICSEARCH_URL=https://elasticsearch.example.com:9200
ELASTICSEARCH_USERNAME=elastic
ELASTICSEARCH_PASSWORD=your_elasticsearch_password

# =============================================================================
# SECURITY HARDENING SETTINGS
# =============================================================================

# Rate Limiting
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_REQUESTS_PER_HOUR=1000
RATE_LIMIT_BURST_LIMIT=10

# Request Security
MAX_REQUEST_SIZE=10485760
MAX_JSON_DEPTH=10
REQUEST_TIMEOUT=30

# IP Security
BLOCKED_IPS=192.168.1.100,10.0.0.50
ALLOWED_IPS=192.168.1.0/24,10.0.0.0/8
WHITELIST_IPS=192.168.1.1,127.0.0.1

# Security Headers
CSP_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline'
HSTS_MAX_AGE=31536000
X_FRAME_OPTIONS=DENY

# =============================================================================
# MFA CONFIGURATION
# =============================================================================

# TOTP Settings
MFA_ISSUER_NAME=Threat Hunter Pro
MFA_WINDOW_SIZE=1
BACKUP_CODE_COUNT=8

# Device Trust
DEVICE_TRUST_DAYS=30
MAX_TRUSTED_DEVICES=5

# =============================================================================
# SESSION MANAGEMENT
# =============================================================================

# Session Timeouts (in minutes)
SESSION_TIMEOUT_MINUTES=60
ABSOLUTE_SESSION_TIMEOUT_HOURS=8
SESSION_RENEWAL_THRESHOLD_MINUTES=15

# Concurrent Sessions
MAX_CONCURRENT_SESSIONS=5
REQUIRE_IP_CONSISTENCY=true
REQUIRE_USER_AGENT_CONSISTENCY=true

# =============================================================================
# PII DETECTION AND REDACTION
# =============================================================================

# PII Detection Settings
PII_DETECTION_SENSITIVITY=0.8
PII_CONFIDENCE_THRESHOLD=0.7
CONTEXT_WINDOW_SIZE=50

# Redaction Settings
REDACTION_STRATEGY_DEFAULT=tokenize
PRESERVE_SECURITY_ENTITIES=true
TOKENIZATION_SALT=your_tokenization_salt_here

# Entity Preservation
PRESERVE_IP_ADDRESSES=true
PRESERVE_FILE_HASHES=true
PRESERVE_DOMAIN_NAMES=true
PRESERVE_PORTS_PROTOCOLS=true

# =============================================================================
# THREAT INTELLIGENCE
# =============================================================================

# Threat Intel Feeds (OPTIONAL)
MISP_URL=https://misp.example.com
MISP_API_KEY=your_misp_api_key
MISP_VERIFY_CERT=true

# Commercial Threat Intel (OPTIONAL)
VIRUSTOTAL_API_KEY=your_virustotal_api_key
ALIENVAULT_API_KEY=your_alienvault_api_key
SHODAN_API_KEY=your_shodan_api_key

# =============================================================================
# EMAIL NOTIFICATIONS
# =============================================================================

# SMTP Configuration (OPTIONAL)
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_USERNAME=your_smtp_username
SMTP_PASSWORD=your_smtp_password
FROM_EMAIL=threathunter@example.com

# Notification Settings
SECURITY_ALERT_EMAIL=security@example.com
ADMIN_EMAIL=admin@example.com
ENABLE_EMAIL_NOTIFICATIONS=true

# =============================================================================
# BACKUP AND RECOVERY
# =============================================================================

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_INTERVAL_HOURS=24
BACKUP_RETENTION_DAYS=30
BACKUP_LOCATION=/var/backups/threat_hunter

# S3 Backup (OPTIONAL)
S3_BACKUP_BUCKET=your-backup-bucket
S3_BACKUP_REGION=us-east-1
S3_BACKUP_PREFIX=threat_hunter_backups/

# =============================================================================
# DEVELOPMENT AND TESTING
# =============================================================================

# Environment Mode
ENVIRONMENT=production
DEBUG_MODE=false
TESTING_MODE=false

# Development Settings (DO NOT USE IN PRODUCTION)
DISABLE_HTTPS_REDIRECT=false
DISABLE_SECURITY_HEADERS=false
DISABLE_RATE_LIMITING=false
DISABLE_INPUT_VALIDATION=false

# Test Database (for testing only)
TEST_DATABASE_URL=sqlite:///test_threathunter.db

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Worker Configuration
WORKERS=4
MAX_CONNECTIONS=1000
KEEPALIVE_TIMEOUT=5

# Caching
CACHE_TTL_SECONDS=300
CACHE_MAX_SIZE=1000
ENABLE_QUERY_CACHE=true

# Vector Database Settings
FAISS_INDEX_TYPE=IndexFlatIP
EMBEDDING_DIMENSION=384
MAX_VECTOR_COUNT=1000000

# =============================================================================
# COMPLIANCE AND AUDITING
# =============================================================================

# Compliance Settings
GDPR_COMPLIANCE_MODE=true
HIPAA_COMPLIANCE_MODE=false
PCI_COMPLIANCE_MODE=false
SOC2_COMPLIANCE_MODE=true

# Audit Settings
AUDIT_LOG_RETENTION_DAYS=2555
DETAILED_AUDIT_LOGGING=true
LOG_SENSITIVE_DATA=false
ANONYMIZE_LOGS=true

# Data Retention
LOG_RETENTION_DAYS=90
VECTOR_DATA_RETENTION_DAYS=365
SESSION_DATA_RETENTION_DAYS=30

# =============================================================================
# CUSTOM EXTENSIONS
# =============================================================================

# Custom Plugin Configuration
ENABLE_CUSTOM_PLUGINS=false
PLUGIN_DIRECTORY=/opt/threat_hunter/plugins
PLUGIN_CONFIG_FILE=/etc/threat_hunter/plugins.conf

# Webhook Configuration
WEBHOOK_URL=https://your-webhook-endpoint.com/alerts
WEBHOOK_SECRET=your_webhook_secret
WEBHOOK_TIMEOUT=10

# =============================================================================
# NOTES AND SECURITY REMINDERS
# =============================================================================

# 1. Never commit this file with real secrets to version control
# 2. Use strong, unique passwords for all services
# 3. Rotate API keys and secrets regularly
# 4. Monitor logs for security events
# 5. Keep the system updated with security patches
# 6. Use HTTPS in production environments
# 7. Implement network segmentation and firewalls
# 8. Regular security audits and penetration testing
# 9. Backup encryption keys securely
# 10. Document your security procedures

# =============================================================================
# EMERGENCY CONTACTS AND PROCEDURES
# =============================================================================

# Security Team Contact
SECURITY_TEAM_EMAIL=security-team@example.com
SECURITY_TEAM_PHONE=+1-555-SECURITY

# Incident Response
INCIDENT_RESPONSE_PLAYBOOK=/opt/threat_hunter/docs/incident_response.md
EMERGENCY_SHUTDOWN_COMMAND=systemctl stop threat-hunter

# Recovery Information
RECOVERY_DOCUMENTATION=/opt/threat_hunter/docs/disaster_recovery.md
BACKUP_RESTORE_PROCEDURE=/opt/threat_hunter/docs/backup_restore.md